@import "tailwindcss";

@theme {
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

:root {
  --background: #f3f4f6;
  /* Gray background */
  --foreground: #1e293b;
  --page-width: 210mm;
  --page-height: 297mm;
  --page-margin: 25.4mm;
  /* 1 inch */
  --column-gap: 24px;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: var(--font-sans);
  margin: 0;
}

/* ============================================
   EDITOR CONTAINER & PAGE
   ============================================ */

.editor-pages {
  width: var(--page-width);
  margin: 0 auto;
  padding: 60px 0;
  display: flex;
  flex-direction: column;
}

.page {
  width: var(--page-width);
  min-height: var(--page-height);
  background: white;
  position: relative;
  /* Outer shadow for the whole "document" container */
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  padding: var(--page-margin);
  padding-bottom: 96px;
  box-sizing: border-box;
}

/* ============================================
   PROSEMIRROR STYLES (Content)
   ============================================ */

.ProseMirror {
  outline: none;
  min-height: 100%;
  font-family: 'Times New Roman', Times, serif;
  font-size: 12pt;
  line-height: 1.5;
}

.ProseMirror p {
  margin: 0;
  margin-bottom: 0.5em;
}

.ProseMirror h1,
.ProseMirror h2,
.ProseMirror h3 {
  margin-top: 1em;
  margin-bottom: 0.5em;
  font-family: 'Arial', sans-serif;
}

/* 
  Fix for inconsistent start/end margins:
  Remove top margin from the first element so it respects the page padding (96px).
  Remove bottom margin from the last element so it respects the page padding (96px).
  Intermediate margins collapse with page-break margins correctly.
*/
.ProseMirror>*:first-child {
  margin-top: 0;
}

.ProseMirror>*:last-child {
  margin-bottom: 0;
}

/* Lists */
.ProseMirror ul {
  list-style-type: disc;
  padding-left: 1.5em;
  margin-bottom: 0.5em;
}

.ProseMirror ol {
  list-style-type: decimal;
  padding-left: 1.5em;
  margin-bottom: 0.5em;
}

.ProseMirror li {
  margin-bottom: 0.25em;
}

/* Tasks */
ul[data-type="taskList"] {
  list-style: none;
  padding: 0;
}

ul[data-type="taskList"] li {
  display: flex;
}

ul[data-type="taskList"] li>label {
  flex: 0 0 auto;
  margin-right: 0.5rem;
  user-select: none;
}

ul[data-type="taskList"] li>div {
  flex: 1 1 auto;
}

/* Tables */
.ProseMirror table {
  border-collapse: collapse;
  table-layout: fixed;
  width: 100%;
  margin: 0;
  overflow: hidden;
}

.ProseMirror td,
.ProseMirror th {
  min-width: 1em;
  border: 2px solid #ced4da;
  padding: 3px 5px;
  vertical-align: top;
  box-sizing: border-box;
  position: relative;
}

.ProseMirror th {
  font-weight: bold;
  text-align: left;
  background-color: #f1f3f5;
}

.ProseMirror .selectedCell:after {
  z-index: 2;
  position: absolute;
  content: "";
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  background: rgba(200, 200, 255, 0.4);
  pointer-events: none;
}

/* ============================================
   PAGINATION INDICATORS
   ============================================ */

/* ============================================
   PAGINATION INDICATORS
   ============================================ */

.page-break {
  /* 
     Robust Box Model Strategy:
     Total Height = 216px.
     - Top 96px: Transparent (Visual Bottom Margin of Page N)
     - Middle 24px: Gray Bar (Visual Gap)
     - Bottom 96px: Transparent (Visual Top Margin of Page N+1)
     
     Using explicit height prevents margin collapsing issues.
  */
  display: flex;
  justify-content: center;
  align-items: center;
  height: 216px;
  position: relative;

  /* Remove vertical margins as they are built into the height */
  margin-top: 0;
  margin-bottom: 0;

  /* Extend to cover side margins */
  margin-left: calc(-1 * var(--page-margin));
  margin-right: calc(-1 * var(--page-margin));

  user-select: none;
  pointer-events: none;
  clear: both;
}

/* The Gray Gap Bar */
.page-break::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 24px;
  background: var(--background);
  transform: translateY(-50%);

  /* Inner shadows for depth */
  box-shadow:
    inset 0 2px 4px rgba(0, 0, 0, 0.1),
    inset 0 -2px 4px rgba(0, 0, 0, 0.05);

  z-index: 0;
}

.page-badge {
  position: relative;
  z-index: 1;
  /* Sit above the gray bar */

  color: #6b7280;
  font-size: 12px;
  font-weight: 500;
  font-family: sans-serif;
  background: white;
  padding: 2px 8px;
  border-radius: 12px;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

/* Page 1 Indicator - Usually hidden or shown at top? */
.page-indicator {
  position: absolute;
  top: -30px;
  right: 0;
  color: #9ca3af;
  font-size: 12px;
  font-family: sans-serif;
}

/* 
   Wait, the user wants "Page number NOT incorrectly placed".
   Often, users expect page numbers in the footer.
   The current implementation puts them in the break gap. 
   To put them "in the page", we'd need fixed footers per A4 block.
   Tiptap/ProseMirror is a continuous flow editor. It doesn't actually have "pages" unless we wrap content.
   My current approach (and the accepted one) creates a continuous strip and simulates pages.
   
   The .page container has `position: relative`.
   But the content inside grows.
   
   Let's ensure the print layout is perfect.
*/


/* ============================================
   PRINT STYLES
   ============================================ */

@media print {
  @page {
    size: A4;
    margin: 25.4mm;
  }

  body {
    background: white;
    margin: 0;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  .editor-pages {
    width: 100%;
    margin: 0;
    padding: 0;
    gap: 0;
    display: block;
    /* Remove flex to let flow naturally */
  }

  .page {
    width: 100%;
    height: auto;
    min-height: 0;
    background: none !important;
    filter: none !important;
    box-shadow: none;
    margin: 0;
    padding: 0;
    /* Margins handled by @page */
    border: none;
    overflow: visible;
  }

  /* Hide the gray gap in print */
  .page-break {
    display: block;
    height: 0;
    margin: 0;
    border: none;
    background: transparent;
    visibility: hidden;
    /* Hide the badge */

    /* Crucial for printing paging */
    break-after: page;
    page-break-after: always;
  }

  /* Hide UI elements */
  .page-indicator {
    display: none;
  }
}